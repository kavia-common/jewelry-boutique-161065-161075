{"is_source_file": true, "format": "TypeScript", "description": "This file defines a Pinia store for managing a shopping cart in a frontend application. It includes state management, getters for cart calculations, actions for loading, adding, updating, and removing cart items, as well as helper functions for handling a guest cart via localStorage. The store interacts with an API via HTTP requests and handles both authenticated and guest users.", "external_files": ["@/api/http", "@/api/types", "./auth"], "external_methods": ["http.get", "http.post", "http.patch", "http.delete", "useAuthStore"], "published": ["useCartStore"], "classes": [], "methods": [{"name": "function normalizeCartItems(data: CartResponse | undefined | null): CartLineItem[] { normalizeCartItems", "description": "Normalizes API cart data to an array of CartLineItem objects, handling different possible response formats.", "scope": "", "scopeKind": ""}, {"name": "function getErrorMessage(error: unknown, fallback: string): string { getErrorMessage", "description": "Extracts a user-friendly error message from an unknown error, especially handling Axios errors.", "scope": "", "scopeKind": ""}, {"name": "readGuestCart", "description": "Reads the guest cart from localStorage and parses it into an array of CartLineItem."}, {"name": "writeGuestCart", "description": "Serializes and saves the guest cart array to localStorage."}, {"name": "clearGuestCart", "description": "Removes the guest cart from localStorage."}], "calls": ["useAuthStore", "http.get", "http.post", "http.patch", "http.delete", "normalizeCartItems", "getErrorMessage"], "search-terms": ["Pinia cart store", "guest cart localStorage", "cart API interactions", "cart item management", "typescript store"], "state": 2, "file_id": 23, "knowledge_revision": 54, "git_revision": "", "revision_history": [{"49": ""}, {"54": ""}], "ctags": [{"_type": "tag", "name": "ApiErrorPayload", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^type ApiErrorPayload = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "CartResponse", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^type CartResponse = { items: CartLineItem[] } | CartLineItem[]$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "CartState", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^interface CartState {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "GUEST_CART_KEY", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^const GUEST_CART_KEY = 'guest_cart'$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "auth", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^      const auth = useAuthStore()$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^          const { data } = await http.delete<CartResponse>(`\\/cart\\/items\\/${itemId}`)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "error", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^  error: string | null$/", "language": "TypeScript", "kind": "property", "scope": "CartState", "scopeKind": "interface"}, {"_type": "tag", "name": "getErrorMessage", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^function getErrorMessage(error: unknown, fallback: string): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^          const items = this.readGuestCart().filter((i) => i.product_id !== product_id)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^  items: CartLineItem[]$/", "language": "TypeScript", "kind": "property", "scope": "CartState", "scopeKind": "interface"}, {"_type": "tag", "name": "loading", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^  loading: boolean$/", "language": "TypeScript", "kind": "property", "scope": "CartState", "scopeKind": "interface"}, {"_type": "tag", "name": "normalizeCartItems", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^function normalizeCartItems(data: CartResponse | undefined | null): CartLineItem[] {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^    const payload = error.response?.data as ApiErrorPayload | undefined$/", "language": "TypeScript", "kind": "constant", "scope": "getErrorMessage", "scopeKind": "function"}, {"_type": "tag", "name": "raw", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^        const raw = localStorage.getItem(GUEST_CART_KEY)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "useCartStore", "path": "/home/kavia/workspace/code-generation/jewelry-boutique-161065-161075/jewelry_shop_frontend/src/stores/cart.ts", "pattern": "/^export const useCartStore = defineStore('cart', {$/", "language": "TypeScript", "kind": "constant"}], "hash": "134a2b8e665f3bc457d8b82abe630673", "format-version": 4, "code-base-name": "jewelry_shop_frontend", "filename": "jewelry_shop_frontend/src/stores/cart.ts", "fields": [{"name": "interface CartState {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "error: string | null", "scope": "CartState", "scopeKind": "interface", "description": "unavailable"}, {"name": "items: CartLineItem[]", "scope": "CartState", "scopeKind": "interface", "description": "unavailable"}, {"name": "loading: boolean", "scope": "CartState", "scopeKind": "interface", "description": "unavailable"}]}